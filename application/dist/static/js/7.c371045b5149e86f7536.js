webpackJsonp([7],{D6Qk:function(t,e){},Ro0N:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const o={control:{unload:"removeControl"},layer:{unload:"removeTileLayer"},overlay:{unload:"removeOverlay"},contextMenu:{unload:"removeContextMenu"}},i=t=>t.abstract||t.$el===t.$children[0].$el?i(t.$parent):t;function s(){const{unload:t,renderByParent:e,$parent:n}=this;e&&n.reload(),t()}var a={"bm-map":["click","dblclick","rightclick","rightdblclick","maptypechange","mousemove","mouseover","mouseout","movestart","moving","moveend","zoomstart","zoomend","addoverlay","addcontrol","removecontrol","removeoverlay","clearoverlays","dragstart","dragging","dragend","addtilelayer","removetilelayer","load","resize","hotspotclick","hotspotover","hotspotout","tilesloaded","touchstart","touchmove","touchend","longpress"],"bm-geolocation":["locationSuccess","locationError"],"bm-overview-map":["viewchanged","viewchanging"],"bm-marker":["click","dblclick","mousedown","mouseup","mouseout","mouseover","remove","infowindowclose","infowindowopen","dragstart","dragging","dragend","rightclick"],"bm-polyline":["click","dblclick","mousedown","mouseup","mouseout","mouseover","remove","lineupdate"],"bm-polygon":["click","dblclick","mousedown","mouseup","mouseout","mouseover","remove","lineupdate"],"bm-circle":["click","dblclick","mousedown","mouseup","mouseout","mouseover","remove","lineupdate"],"bm-label":["click","dblclick","mousedown","mouseup","mouseout","mouseover","remove","rightclick"],"bm-info-window":["close","open","maximize","restore","clickclose"],"bm-ground":["click","dblclick"],"bm-autocomplete":["onconfirm","onhighlight"],"bm-point-collection":["click","mouseover","mouseout"]};function r(t,e={}){const{lng:n,lat:o}=e;return new t.Point(n,o)}var l={name:"new-polyline",render:function(){},mixins:[(t=>new class{constructor(t){this.methods={ready(){const t=i(this.$parent),e=this.BMap=t.BMap,n=this.map=t.map;this.load(),this.$emit("ready",{BMap:e,map:n})},transmitEvent(t){this.$emit(t.type.replace(/^on/,""),t)},reload(){this&&this.BMap&&this.$nextTick(()=>{this.unload(),this.$nextTick(this.load)})},unload(){const{map:e,originInstance:n}=this;try{switch(t.type){case"search":return n.clearResults();case"autoComplete":case"lushu":return n.dispose();case"markerClusterer":return n.clearMarkers();default:e[o[t.type].unload](n)}}catch(t){}}},this.computed={renderByParent(){return this.$parent.preventChildrenRender}},this.mounted=function(){const t=i(this.$parent),e=t.map,{ready:n}=this;e?n():t.$on("ready",n)},this.destroyed=s,this.beforeDestroy=s}}({type:t}))("overlay")],props:{path:{type:Array},icons:{type:Array},strokeColor:{type:String},strokeWeight:{type:Number},strokeOpacity:{type:Number},strokeStyle:{type:String},massClear:{type:Boolean,default:!0},clicking:{type:Boolean,default:!0},editing:{type:Boolean,default:!1}},watch:{path:{handler:function(t,e){this.reload()},deep:!0},strokeColor:function(t){this.originInstance.setStrokeColor(t)},strokeOpacity:function(t){this.originInstance.setStrokeOpacity(t)},strokeWeight:function(t){this.originInstance.setStrokeWeight(t)},strokeStyle:function(t){this.originInstance.setStrokeStyle(t)},editing:function(t){t?this.originInstance.enableEditing():this.originInstance.disableEditing()},massClear:function(t){t?this.originInstance.enableMassClear():this.originInstance.disableMassClear()},clicking:function(t){this.reload()}},methods:{load:function(){var t=this.BMap,e=this.map,n=this.path,o=this.icons,i=this.strokeColor,s=this.strokeWeight,l=this.strokeOpacity,c=this.strokeStyle,d=this.editing,u=this.massClear,m=this.clicking,p=new t.Polyline(n.map(function(e){return r(t,{lng:parseFloat(e.lng),lat:parseFloat(e.lat)})}),{strokeColor:i,strokeWeight:s,strokeOpacity:l,strokeStyle:c,icons:o,enableEditing:d,enableMassClear:u,enableClicking:m});this.originInstance=p,e.addOverlay(p),function(t,e){const n=e||a[this.$options.name];n&&n.forEach(e=>{const n="on"===e.slice(0,2)?e.slice(2):e,o=this.$listeners[n];o&&t.addEventListener(e,o.fns)})}.call(this,p)}}},c=n("VU/8")(l,null,!1,null,null,null).exports,d=n("Dd8w"),u=n.n(d),m=n("NYxO"),p=n("raiF"),g={components:{newPolyline:c},name:"AllDonating",data:function(){return{center:{lng:116.404,lat:39.915},zoom:5,points:[],icons:[],loading:!0,donatingList:[],logistics:!1,activities:[{content:"已发货:南京市",timestamp:"2020-11-10 08：30",size:"large",type:"primary",icon:"el-icon-more"},{content:"运输中：到达合肥市",timestamp:"2020-11-12 12：00",color:"#0bbd87",size:"large",icon:"el-icon-s-promotion"},{content:"运输中：到达武汉市",timestamp:"2020-11-14 20：00",color:"#409EFF",size:"large",icon:"el-icon-s-promotion"},{content:"已签收 华中科技大学同济医学院附属同济医院",timestamp:"2020-11-15 10：00",color:"#fb7293",size:"large",icon:"el-icon-s-flag"}]}},computed:u.a({},m.b(["accountId","roles","userName","balance"])),created:function(){var t=this;p.b().then(function(e){null!==e&&(t.donatingList=e),t.loading=!1}).catch(function(e){t.loading=!1})},methods:{ready:function(t){var e=t.BMap,n=t.map;this.points=this.getPointsSomehow();var o=new e.Symbol(BMap_Symbol_SHAPE_FORWARD_OPEN_ARROW,{scale:.5,strokeColor:"#fff",strokeWeight:"3"}),i=new e.IconSequence(o,"5%","15%");this.icons.push(i),console.log(this.points),n.addOverlay(this.points)},getPointsSomehow:function(){return[{lng:118.780133,lat:32.069235},{lng:117.291117,lat:31.798837},{lng:114.316551,lat:30.528813},{lng:114.274665,lat:30.584394}]},checkPoints:function(t){for(var e=t.points,n=e[0],o=1;o<e.length;o++)if(e[o].lat!==n.lat||e[o].lng!==n.lng)return!0;return!1},updateDonating:function(t,e){var n=this,o="";o="done"===e?"确认接受捐赠":"取消捐赠操作",this.$confirm("是否要"+o+"?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"success"}).then(function(){n.loading=!0,p.c({donor:t.donor,grantee:t.grantee,objectOfDonating:t.objectOfDonating,status:e}).then(function(t){n.loading=!1,null!==t?n.$message({type:"success",message:o+"操作成功!"}):n.$message({type:"error",message:o+"操作失败!"}),setTimeout(function(){window.location.reload()},1e3)}).catch(function(t){n.loading=!1})}).catch(function(){n.loading=!1,n.$message({type:"info",message:"已取消"+o})})}}},h={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"container"},[n("el-alert",{attrs:{type:"success"}},[n("p",[t._v("账户ID: "+t._s(t.accountId))]),t._v(" "),n("p",[t._v("用户名: "+t._s(t.userName))]),t._v(" "),n("p",[t._v("余额: ￥"+t._s(t.balance)+" 元")])]),t._v(" "),0==t.donatingList.length?n("div",{staticStyle:{"text-align":"center"}},[n("el-alert",{attrs:{title:"查询不到数据",type:"warning"}})],1):t._e(),t._v(" "),n("el-row",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{gutter:20}},t._l(t.donatingList,function(e,o){return n("el-col",{key:o,attrs:{span:6,offset:1}},[n("el-card",{staticClass:"d-all-card"},[n("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[n("span",[t._v(t._s(e.donatingStatus))]),t._v(" "),"admin"!==t.roles[0]&&e.grantee===t.accountId&&"捐赠中"===e.donatingStatus?n("el-button",{staticStyle:{float:"right",padding:"3px 6px"},attrs:{type:"text"},on:{click:function(n){return t.updateDonating(e,"done")}}},[t._v("确认接收")]):t._e(),t._v(" "),"admin"===t.roles[0]||e.donor!==t.accountId&&e.grantee!==t.accountId||"捐赠中"!==e.donatingStatus?t._e():n("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:function(n){return t.updateDonating(e,"cancelled")}}},[t._v("取消")])],1),t._v(" "),n("div",{staticClass:"item"},[n("el-tag",[t._v("房产ID: ")]),t._v(" "),n("span",[t._v(t._s(e.objectOfDonating))])],1),t._v(" "),n("div",{staticClass:"item"},[n("el-tag",{attrs:{type:"success"}},[t._v("捐赠者ID: ")]),t._v(" "),n("span",[t._v(t._s(e.donor))])],1),t._v(" "),n("div",{staticClass:"item"},[n("el-tag",{attrs:{type:"danger"}},[t._v("受赠人ID: ")]),t._v(" "),n("span",[t._v(t._s(e.grantee))])],1),t._v(" "),n("div",{staticClass:"item"},[n("el-tag",{attrs:{type:"warning"}},[t._v("创建时间: ")]),t._v(" "),n("span",[t._v(t._s(e.createTime))])],1),t._v(" "),n("el-popover",{attrs:{placement:"right",width:"500",trigger:"click"}},[n("baidu-map",{staticClass:"map",attrs:{"scroll-wheel-zoom":!0,center:t.center,zoom:t.zoom},on:{ready:t.ready}},[t.points&&t.points.length>=2&&t.checkPoints({points:t.points})?n("new-polyline",{attrs:{path:t.points,icons:t.icons,"stroke-color":"#0091ea","stroke-opacity":.8,"stroke-weight":10}}):t._e()],1),t._v(" "),n("h4",[t._v("药品ID"+t._s(e.objectOfDonating))]),t._v(" "),n("el-timeline",t._l(t.activities,function(e,o){return n("el-timeline-item",{key:o,attrs:{icon:e.icon,type:e.type,color:e.color,size:e.size,timestamp:e.timestamp}},[t._v("\n                "+t._s(e.content)+"\n              ")])}),1),t._v(" "),n("el-button",{attrs:{slot:"reference"},slot:"reference"},[t._v("点击查看物流信息")])],1)],1)],1)}),1)],1)},staticRenderFns:[]};var v=n("VU/8")(g,h,!1,function(t){n("D6Qk")},null,null);e.default=v.exports}});
//# sourceMappingURL=7.c371045b5149e86f7536.js.map