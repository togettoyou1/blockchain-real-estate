{"version":3,"sources":["webpack:///./src/api/drugRequest.js","webpack:///src/views/drugRequest/list/index.vue","webpack:///./src/views/drugRequest/list/index.vue?b2cc","webpack:///./src/views/drugRequest/list/index.vue"],"names":["__webpack_exports__","data","request","url","method","__WEBPACK_IMPORTED_MODULE_0__utils_request__","__webpack_require__","list_defaultExport","name","checkArea","rule","value","callback","Error","loading","loadingDialog","drugRequestList","dialogCreateSelling","dialogCreateDonating","realForm","price","salePeriod","rules","validator","trigger","DonatingForm","proprietor","rulesDonating","required","message","accountList","valItem","computed","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_extends___default","a","__WEBPACK_IMPORTED_MODULE_1_vuex__","created","_this","this","__WEBPACK_IMPORTED_MODULE_3__api_drugRequest__","then","response","catch","_","methods","openDialog","item","openDonatingDialog","_this2","__WEBPACK_IMPORTED_MODULE_2__api_account__","filter","userName","accountId","createSelling","formName","_this3","$refs","validate","valid","$confirm","confirmButtonText","cancelButtonText","type","__WEBPACK_IMPORTED_MODULE_4__api_selling__","objectOfSale","drugRequestId","seller","$message","setTimeout","window","location","reload","createDonating","_this4","__WEBPACK_IMPORTED_MODULE_5__api_donating__","objectOfDonating","donor","grantee","resetForm","resetFields","selectGet","drugRequest_list_defaultExport","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","_v","_s","balance","length","staticStyle","text-align","title","_e","directives","rawName","expression","gutter","_l","val","index","key","span","offset","slot","color","encumbrance","drugName","tradeName","drugNumber","roles","on","click","$event","direction","visible","close-on-click-modal","update:visible","close","ref","model","label-width","label","prop","precision","step","min","$$v","$set","placeholder","change","float","font-size","staticRenderFns","Component","normalizeComponent","ssrContext"],"mappings":"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","file":"static/js/5.f3651deb4bea68d461cc.js","sourcesContent":["import request from '@/utils/request'\n\n// 新建需求\nexport function createDrugRequest(data) {\n  return request({\n    url: '/createDrugRequest',\n    method: 'post',\n    data\n  })\n}\n\n// 获取需求信息(空json{}可以查询所有，指定proprietor可以查询指定用户名下的需求信息)\nexport function queryDrugRequestList(data) {\n  return request({\n    url: '/queryDrugRequestList',\n    method: 'post',\n    data\n  })\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/api/drugRequest.js","<template>\n  <div class=\"container\">\n    <el-alert\n      type=\"success\"\n    >\n      <p>账户ID: {{ accountId }}</p>\n      <p>用户名: {{ userName }}</p>\n      <p>余额: ￥{{ balance }} 元</p>\n      <p>当发起出售、捐赠或质押操作后，担保状态为true</p>\n      <p>当担保状态为false时，才可发起出售、捐赠或质押操作</p>\n    </el-alert>\n    <div v-if=\"drugRequestList.length==0\" style=\"text-align: center;\">\n      <el-alert\n        title=\"查询不到数据\"\n        type=\"warning\"\n      />\n    </div>\n    <el-row v-loading=\"loading\" :gutter=\"20\">\n      <el-col v-for=\"(val,index) in drugRequestList\" :key=\"index\" :span=\"6\" :offset=\"1\">\n        <el-card class=\"drugRequest-card\">\n          <div slot=\"header\" class=\"clearfix\">\n            担保状态:\n            <span style=\"color: rgb(255, 0, 0);\">{{ val.encumbrance }}</span>\n          </div>\n\n          <div class=\"item\">\n            <el-tag>药品ID: </el-tag>\n            <span>{{ val.drugRequestId }}</span>\n          </div>\n          <div class=\"item\">\n            <el-tag type=\"success\">用户ID: </el-tag>\n            <span>{{ val.proprietor }}</span>\n          </div>\n          <div class=\"item\">\n            <el-tag type=\"warning\">药品名称: </el-tag>\n            <span>{{ val.drugName }}</span>\n          </div>\n\n          <div class=\"item\">\n            <el-tag type=\"warning\">商品名称: </el-tag>\n            <span>{{ val.tradeName }}</span>\n          </div>\n          \n          <div class=\"item\">\n            <el-tag type=\"danger\">数量: </el-tag>\n            <span>{{ val.drugNumber }} 件</span>\n          </div>\n\n          <div v-if=\"!val.encumbrance&&val.proprietor!==accountId&&roles[0] !== 'admin'\">\n            <el-button type=\"text\" @click=\"openDialog(val)\">出售给ta</el-button>\n            <el-divider direction=\"vertical\" />\n            <el-button type=\"text\" @click=\"openDonatingDialog(val)\">捐赠给ta</el-button>\n          </div>\n          <el-rate v-if=\"val.proprietor==accountId||roles[0] === 'admin'\" />\n        </el-card>\n      </el-col>\n    </el-row>\n    <el-dialog v-loading=\"loadingDialog\" :visible.sync=\"dialogCreateSelling\" :close-on-click-modal=\"false\" @close=\"resetForm('realForm')\">\n      <el-form ref=\"realForm\" :model=\"realForm\" :rules=\"rules\" label-width=\"100px\">\n        <el-form-item label=\"价格 (元)\" prop=\"price\">\n          <el-input-number v-model=\"realForm.price\" :precision=\"2\" :step=\"10000\" :min=\"0\" />\n        </el-form-item>\n        <el-form-item label=\"有效期 (天)\" prop=\"salePeriod\">\n          <el-input-number v-model=\"realForm.salePeriod\" :min=\"1\" />\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button type=\"primary\" @click=\"createSelling('realForm')\">立即出售</el-button>\n        <el-button @click=\"dialogCreateSelling = false\">取 消</el-button>\n      </div>\n    </el-dialog>\n    <el-dialog v-loading=\"loadingDialog\" :visible.sync=\"dialogCreateDonating\" :close-on-click-modal=\"false\" @close=\"resetForm('DonatingForm')\">\n      <el-form ref=\"DonatingForm\" :model=\"DonatingForm\" :rules=\"rulesDonating\" label-width=\"100px\">\n        <el-form-item label=\"用户\" prop=\"proprietor\">\n          <el-select v-model=\"DonatingForm.proprietor\" placeholder=\"请选择用户\" @change=\"selectGet\">\n            <el-option\n              v-for=\"item in accountList\"\n              :key=\"item.accountId\"\n              :label=\"item.userName\"\n              :value=\"item.accountId\"\n            >\n              <span style=\"float: left\">{{ item.userName }}</span>\n              <span style=\"float: right; color: #8492a6; font-size: 13px\">{{ item.accountId }}</span>\n            </el-option>\n          </el-select>\n        </el-form-item>\n      </el-form>\n      <div slot=\"footer\" class=\"dialog-footer\">\n        <el-button type=\"primary\" @click=\"createDonating('DonatingForm')\">立即捐赠</el-button>\n        <el-button @click=\"dialogCreateDonating = false\">取 消</el-button>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport { mapGetters } from 'vuex'\nimport { queryAccountList } from '@/api/account'\nimport { queryDrugRequestList } from '@/api/drugRequest'\nimport { createSelling } from '@/api/selling'\nimport { createDonating } from '@/api/donating'\n\nexport default {\n  name: 'DrugRequest',\n  data() {\n    var checkArea = (rule, value, callback) => {\n      if (value <= 0) {\n        callback(new Error('必须大于0'))\n      } else {\n        callback()\n      }\n    }\n    return {\n      loading: true,\n      loadingDialog: false,\n      drugRequestList: [],\n      dialogCreateSelling: false,\n      dialogCreateDonating: false,\n      realForm: {\n        price: 0,\n        salePeriod: 0\n      },\n      rules: {\n        price: [\n          { validator: checkArea, trigger: 'blur' }\n        ],\n        salePeriod: [\n          { validator: checkArea, trigger: 'blur' }\n        ]\n      },\n      DonatingForm: {\n        proprietor: ''\n      },\n      rulesDonating: {\n        proprietor: [\n          { required: true, message: '请选择用户', trigger: 'change' }\n        ]\n      },\n      accountList: [],\n      valItem: {}\n    }\n  },\n  computed: {\n    ...mapGetters([\n      'accountId',\n      'roles',\n      'userName',\n      'balance'\n    ])\n  },\n  created() {\n    queryDrugRequestList().then(response => {\n      if (response !== null) {\n        this.drugRequestList = response\n      }\n      this.loading = false\n    }).catch(_ => {\n      this.loading = false\n    })\n    // if (this.roles[0] === 'admin') {\n    //   queryDrugRequestList().then(response => {\n    //     if (response !== null) {\n    //       this.drugRequestList = response\n    //     }\n    //     this.loading = false\n    //   }).catch(_ => {\n    //     this.loading = false\n    //   })\n    // } else {\n    //   queryDrugRequestList({ proprietor: this.accountId }).then(response => {\n    //     if (response !== null) {\n    //       this.drugRequestList = response\n    //     }\n    //     this.loading = false\n    //   }).catch(_ => {\n    //     this.loading = false\n    //   })\n    // }\n  },\n  methods: {\n    openDialog(item) {\n      this.dialogCreateSelling = true\n      this.valItem = item\n    },\n    openDonatingDialog(item) {\n      this.dialogCreateDonating = true\n      this.valItem = item\n      queryAccountList().then(response => {\n        if (response !== null) {\n          // 过滤掉管理员和当前用户\n          this.accountList = response.filter(item =>\n            item.userName !== '管理员' && item.accountId !== this.accountId\n          )\n        }\n      })\n    },\n    createSelling(formName) {\n      this.$refs[formName].validate((valid) => {\n        if (valid) {\n          this.$confirm('是否立即出售?', '提示', {\n            confirmButtonText: '确定',\n            cancelButtonText: '取消',\n            type: 'success'\n          }).then(() => {\n            this.loadingDialog = true\n            createSelling({\n              objectOfSale: this.valItem.drugRequestId,\n              seller: this.valItem.proprietor,\n              price: this.realForm.price,\n              salePeriod: this.realForm.salePeriod\n            }).then(response => {\n              this.loadingDialog = false\n              this.dialogCreateSelling = false\n              if (response !== null) {\n                this.$message({\n                  type: 'success',\n                  message: '出售成功!'\n                })\n              } else {\n                this.$message({\n                  type: 'error',\n                  message: '出售失败!'\n                })\n              }\n              setTimeout(() => {\n                window.location.reload()\n              }, 1000)\n            }).catch(_ => {\n              this.loadingDialog = false\n              this.dialogCreateSelling = false\n            })\n          }).catch(() => {\n            this.loadingDialog = false\n            this.dialogCreateSelling = false\n            this.$message({\n              type: 'info',\n              message: '已取消出售'\n            })\n          })\n        } else {\n          return false\n        }\n      })\n    },\n    createDonating(formName) {\n      this.$refs[formName].validate((valid) => {\n        if (valid) {\n          this.$confirm('是否立即捐赠?', '提示', {\n            confirmButtonText: '确定',\n            cancelButtonText: '取消',\n            type: 'success'\n          }).then(() => {\n            this.loadingDialog = true\n            createDonating({\n              objectOfDonating: this.valItem.drugRequestId,\n              donor: this.valItem.proprietor,\n              grantee: this.DonatingForm.proprietor\n            }).then(response => {\n              this.loadingDialog = false\n              this.dialogCreateDonating = false\n              if (response !== null) {\n                this.$message({\n                  type: 'success',\n                  message: '捐赠成功!'\n                })\n              } else {\n                this.$message({\n                  type: 'error',\n                  message: '捐赠失败!'\n                })\n              }\n              setTimeout(() => {\n                window.location.reload()\n              }, 1000)\n            }).catch(_ => {\n              this.loadingDialog = false\n              this.dialogCreateDonating = false\n            })\n          }).catch(() => {\n            this.loadingDialog = false\n            this.dialogCreateDonating = false\n            this.$message({\n              type: 'info',\n              message: '已取消捐赠'\n            })\n          })\n        } else {\n          return false\n        }\n      })\n    },\n    resetForm(formName) {\n      this.$refs[formName].resetFields()\n    },\n    selectGet(accountId) {\n      this.DonatingForm.proprietor = accountId\n    }\n  }\n}\n\n</script>\n\n<style>\n  .container{\n    width: 100%;\n    text-align: center;\n    min-height: 100%;\n    overflow: hidden;\n  }\n  .tag {\n    float: left;\n  }\n\n  .item {\n    font-size: 14px;\n    margin-bottom: 18px;\n    color: #999;\n  }\nd\n  .clearfix:before,\n  .clearfix:after {\n    display: table;\n  }\n  .clearfix:after {\n    clear: both\n  }\n\n  .DrugRequest-card {\n    width: 280px;\n    height: 380px;\n    margin: 18px;\n  }\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/views/drugRequest/list/index.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"container\"},[_c('el-alert',{attrs:{\"type\":\"success\"}},[_c('p',[_vm._v(\"账户ID: \"+_vm._s(_vm.accountId))]),_vm._v(\" \"),_c('p',[_vm._v(\"用户名: \"+_vm._s(_vm.userName))]),_vm._v(\" \"),_c('p',[_vm._v(\"余额: ￥\"+_vm._s(_vm.balance)+\" 元\")]),_vm._v(\" \"),_c('p',[_vm._v(\"当发起出售、捐赠或质押操作后，担保状态为true\")]),_vm._v(\" \"),_c('p',[_vm._v(\"当担保状态为false时，才可发起出售、捐赠或质押操作\")])]),_vm._v(\" \"),(_vm.drugRequestList.length==0)?_c('div',{staticStyle:{\"text-align\":\"center\"}},[_c('el-alert',{attrs:{\"title\":\"查询不到数据\",\"type\":\"warning\"}})],1):_vm._e(),_vm._v(\" \"),_c('el-row',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loading),expression:\"loading\"}],attrs:{\"gutter\":20}},_vm._l((_vm.drugRequestList),function(val,index){return _c('el-col',{key:index,attrs:{\"span\":6,\"offset\":1}},[_c('el-card',{staticClass:\"drugRequest-card\"},[_c('div',{staticClass:\"clearfix\",attrs:{\"slot\":\"header\"},slot:\"header\"},[_vm._v(\"\\n          担保状态:\\n          \"),_c('span',{staticStyle:{\"color\":\"rgb(255, 0, 0)\"}},[_vm._v(_vm._s(val.encumbrance))])]),_vm._v(\" \"),_c('div',{staticClass:\"item\"},[_c('el-tag',[_vm._v(\"药品ID: \")]),_vm._v(\" \"),_c('span',[_vm._v(_vm._s(val.drugRequestId))])],1),_vm._v(\" \"),_c('div',{staticClass:\"item\"},[_c('el-tag',{attrs:{\"type\":\"success\"}},[_vm._v(\"用户ID: \")]),_vm._v(\" \"),_c('span',[_vm._v(_vm._s(val.proprietor))])],1),_vm._v(\" \"),_c('div',{staticClass:\"item\"},[_c('el-tag',{attrs:{\"type\":\"warning\"}},[_vm._v(\"药品名称: \")]),_vm._v(\" \"),_c('span',[_vm._v(_vm._s(val.drugName))])],1),_vm._v(\" \"),_c('div',{staticClass:\"item\"},[_c('el-tag',{attrs:{\"type\":\"warning\"}},[_vm._v(\"商品名称: \")]),_vm._v(\" \"),_c('span',[_vm._v(_vm._s(val.tradeName))])],1),_vm._v(\" \"),_c('div',{staticClass:\"item\"},[_c('el-tag',{attrs:{\"type\":\"danger\"}},[_vm._v(\"数量: \")]),_vm._v(\" \"),_c('span',[_vm._v(_vm._s(val.drugNumber)+\" 件\")])],1),_vm._v(\" \"),(!val.encumbrance&&val.proprietor!==_vm.accountId&&_vm.roles[0] !== 'admin')?_c('div',[_c('el-button',{attrs:{\"type\":\"text\"},on:{\"click\":function($event){return _vm.openDialog(val)}}},[_vm._v(\"出售给ta\")]),_vm._v(\" \"),_c('el-divider',{attrs:{\"direction\":\"vertical\"}}),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"text\"},on:{\"click\":function($event){return _vm.openDonatingDialog(val)}}},[_vm._v(\"捐赠给ta\")])],1):_vm._e(),_vm._v(\" \"),(val.proprietor==_vm.accountId||_vm.roles[0] === 'admin')?_c('el-rate'):_vm._e()],1)],1)}),1),_vm._v(\" \"),_c('el-dialog',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loadingDialog),expression:\"loadingDialog\"}],attrs:{\"visible\":_vm.dialogCreateSelling,\"close-on-click-modal\":false},on:{\"update:visible\":function($event){_vm.dialogCreateSelling=$event},\"close\":function($event){return _vm.resetForm('realForm')}}},[_c('el-form',{ref:\"realForm\",attrs:{\"model\":_vm.realForm,\"rules\":_vm.rules,\"label-width\":\"100px\"}},[_c('el-form-item',{attrs:{\"label\":\"价格 (元)\",\"prop\":\"price\"}},[_c('el-input-number',{attrs:{\"precision\":2,\"step\":10000,\"min\":0},model:{value:(_vm.realForm.price),callback:function ($$v) {_vm.$set(_vm.realForm, \"price\", $$v)},expression:\"realForm.price\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"有效期 (天)\",\"prop\":\"salePeriod\"}},[_c('el-input-number',{attrs:{\"min\":1},model:{value:(_vm.realForm.salePeriod),callback:function ($$v) {_vm.$set(_vm.realForm, \"salePeriod\", $$v)},expression:\"realForm.salePeriod\"}})],1)],1),_vm._v(\" \"),_c('div',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.createSelling('realForm')}}},[_vm._v(\"立即出售\")]),_vm._v(\" \"),_c('el-button',{on:{\"click\":function($event){_vm.dialogCreateSelling = false}}},[_vm._v(\"取 消\")])],1)],1),_vm._v(\" \"),_c('el-dialog',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loadingDialog),expression:\"loadingDialog\"}],attrs:{\"visible\":_vm.dialogCreateDonating,\"close-on-click-modal\":false},on:{\"update:visible\":function($event){_vm.dialogCreateDonating=$event},\"close\":function($event){return _vm.resetForm('DonatingForm')}}},[_c('el-form',{ref:\"DonatingForm\",attrs:{\"model\":_vm.DonatingForm,\"rules\":_vm.rulesDonating,\"label-width\":\"100px\"}},[_c('el-form-item',{attrs:{\"label\":\"用户\",\"prop\":\"proprietor\"}},[_c('el-select',{attrs:{\"placeholder\":\"请选择用户\"},on:{\"change\":_vm.selectGet},model:{value:(_vm.DonatingForm.proprietor),callback:function ($$v) {_vm.$set(_vm.DonatingForm, \"proprietor\", $$v)},expression:\"DonatingForm.proprietor\"}},_vm._l((_vm.accountList),function(item){return _c('el-option',{key:item.accountId,attrs:{\"label\":item.userName,\"value\":item.accountId}},[_c('span',{staticStyle:{\"float\":\"left\"}},[_vm._v(_vm._s(item.userName))]),_vm._v(\" \"),_c('span',{staticStyle:{\"float\":\"right\",\"color\":\"#8492a6\",\"font-size\":\"13px\"}},[_vm._v(_vm._s(item.accountId))])])}),1)],1)],1),_vm._v(\" \"),_c('div',{staticClass:\"dialog-footer\",attrs:{\"slot\":\"footer\"},slot:\"footer\"},[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.createDonating('DonatingForm')}}},[_vm._v(\"立即捐赠\")]),_vm._v(\" \"),_c('el-button',{on:{\"click\":function($event){_vm.dialogCreateDonating = false}}},[_vm._v(\"取 消\")])],1)],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-6e98c198\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/views/drugRequest/list/index.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-6e98c198\\\",\\\"scoped\\\":false,\\\"hasInlineConfig\\\":false}!../../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./index.vue\")\n}\nvar normalizeComponent = require(\"!../../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./index.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../../node_modules/vue-loader/lib/selector?type=script&index=0!./index.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-6e98c198\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../../node_modules/vue-loader/lib/selector?type=template&index=0!./index.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/views/drugRequest/list/index.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}